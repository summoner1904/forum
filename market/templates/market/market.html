{% load humanize %}
{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Маркет</title>
    <link rel="stylesheet" href="{% static 'market/assets/bootstrap/css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'market/assets/css/animate.min.css' %}">
    <link rel="stylesheet" href="{% static 'market/assets/css/styles.css' %}">
</head>

<body class="bg-dark">
<nav class="navbar navbar-dark navbar-expand-md sticky-top py-3" style="background: #1f1f1f;">
    <div class="container"><a class="navbar-brand d-flex align-items-center" href="{% url 'market:index' %}"><span
            class="fs-5 fw-bold">ITPONIC</span></a>
        <button data-bs-toggle="collapse" class="navbar-toggler" data-bs-target="#navcol-4"><span
                class="visually-hidden">Toggle navigation</span><span class="navbar-toggler-icon"></span></button>
        <div class="collapse navbar-collapse flex-grow-0 order-md-first" id="navcol-4">
            <ul class="navbar-nav me-auto">
                <li class="nav-item"><a class="nav-link active" href="{% url 'market:index' %}">Главная</a></li>
                <li class="nav-item"><a class="nav-link" href="{% url 'market:market' %}">Маркет</a></li>
                <li class="nav-item"><a class="nav-link" href="#">Сообщество</a></li>
            </ul>
            {% if user.is_authenticated %}
                <div class="d-md-none my-2"><a href="{% url 'cabinet:profile' user.pk %}" class="btn btn-light me-2"
                                               type="button">Профиль</a><a href="{% url 'account_logout' %}"
                                                                           class="btn btn-danger"
                                                                           type="button">Выйти</a></div>
                </div>
                <div class="d-none d-md-block"><a href="{% url 'cabinet:profile' user.pk %}" class="btn btn-light me-2"
                                                  type="button">Профиль</a><a href="{% url 'account_logout' %}"
                                                                              class="btn btn-danger"
                                                                              role="button">Выйти</a></div>
            {% else %}
                <div class="d-md-none my-2"><a href="{% url 'account_signup' %}" class="btn btn-light me-2"
                                               type="button">Зарегистрироваться</a><a href="{% url 'account_login' %}"
                                                                                      class="btn btn-primary"
                                                                                      type="button">Войти</a></div>
                </div>
                <div class="d-none d-md-block"><a href="{% url 'account_signup' %}" class="btn btn-light me-2"
                                                  type="button">Зарегистрироваться</a><a class="btn btn-primary"
                                                                                         role="button"
                                                                                         href="{% url 'account_login' %}">Войти</a>
                </div>
            {% endif %}
</nav>
<div class="container" style="margin-top: 75px;">
    <div class="row">
        <div class="col-md-6 col-xxl-3 offset-xxl-0"
             style="background: #1f1f1f;padding: 30px;border-radius: 20px;height: 100%;">
            <button class="btn btn-danger" type="button" style="width:100%;margin-bottom:30px;" id="openModalBtn">
                Продать товар
            </button>
            <div style="color:white;display:none;" id="modalBlockId" class="modalBlock">
                <div class="modal-content" id="modalContentId">
                    <div class="block_for_close_button">
                        <button id="closeModalBtn" class="btn_close" style="background:none;border:none;color: grey;">
                            Закрыть
                        </button>
                    </div>
                    <form action="{% url 'market:market' %}" method="post">
                        {% csrf_token %}
                        {% for i in sell %}
                            <div class="form_inp">
                                <div class="form_label">{{ i.label }}</div>
                                <div class="form_input">{{ i }}</div>
                            </div>
                        {% endfor %}
                        <button type="submit" class="btn-sell btn btn-danger" style="width: 100%;">Продать</button>
                    </form>
                </div>

            </div>
            <style>
                .form_label {
                    margin-bottom: 5px;
                }

                .form_inp {
                    margin-bottom: 20px;
                }

                .block_for_close_button {
                    justify-content: flex-end;
                    display: flex;
                }

                .modalBlock {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    background-color: rgba(0, 0, 0, 0.5);
                }

                .modal-content {
                    border-radius: 10px;
                    background-color: #1a1a1a;
                    margin: 15% auto;
                    padding: 20px;
                    width: 400px;
                }
            </style>
            <script>
                var btnOpen = document.getElementById("openModalBtn");
                var btnClose = document.getElementById("closeModalBtn");
                var block = document.getElementById("modalBlockId")
                btnOpen.onclick = function () {
                    block.style.display = "block";
                }
                btnClose.onclick = function () {
                    block.style.display = "none";
                }
            </script>
            <h5 class="text-light">Основное</h5>
            <p class="text-light" style="margin-left: 20px;">Торговля</p>
            <p class="text-light" style="margin-left: 20px;">Работа и услуги</p>
            <p class="text-light" style="margin-left: 20px;">Арбитражи</p>
            <h5 class="text-light">Тематическое</h5>
            <p class="text-light" style="margin-left: 20px;">Статьи</p>
            <p class="text-light" style="margin-left: 20px;">ChatGPT</p>
            <p class="text-light" style="margin-left: 20px;">Софт</p>
            <p class="text-light" style="margin-left: 20px;">Тематические вопросы</p>
            <h5 class="text-light">Общий раздел</h5>
            <p class="text-light" style="margin-left: 20px;">Компьютеры</p>
            <p class="text-light" style="margin-left: 20px;">Телефоны</p>
            <p class="text-light" style="margin-left: 20px;">Программирование</p>
            <p class="text-light" style="margin-left: 20px;">Веб-разработка</p>
        </div>
        <div class="col-md-6 col-xxl-8 offset-xxl-1 pulse animated"
             style="background: #1f1f1f;padding: 30px;border-radius: 20px;padding-left: 50px;">
            <h3 class="text-muted">Маркет</h3>
            {% if messages %}
                {% for message in messages %}
                    <div class="{{ message.tags }}"
                         style="color: white;font-size: 18px;padding:20px;border-radius: 10px;">
                        {{ message }}
                    </div>
                {% endfor %}
                <style>
                    .error {
                        background-color: rgb(220, 53, 69);
                    }

                    .success {
                        background-color: rgb(25, 135, 84);
                    }
                </style>
            {% else %}
                <p class="text-muted">Раздел форума, позволяющий пользователям выставлять свои аккаунты на продажу.
                    Обратите
                    внимание, что выкладывать объявления могут только зарегистрированные пользователи, оплатившие данную
                    возможность.&nbsp;<br><br>Если возникли проблемы с аккаунтом, создайте арбитраж с подробным
                    описанием
                    проблемы.</p>
            {% endif %}
            <div class="row">
                <div class="col">
                    <form action="{% url 'market:market' %}" method="post">
                        {% csrf_token %}
                        <h5 class="text-muted">Фильтры поиска</h5>
                        {{ form.title_input }}
                        <p class="text-muted" style="margin-top:30px;">Цена</p>
                        {{ form.min_price }}
                        {{ form.max_price }}
                        <button class="btn btn-success" style="width:100%;margin-top: 30px;height: 50px;" type="submit">
                            Применить
                        </button>
                    </form>
                </div>
            </div>
            <div class="card text-light"
                 style="margin-top: 50px;border-style: none;border-radius: 20px;background: rgb(31,31,31);">
                {% for item in items %}
                    <div class="card-body bg-dark border-0 d-block"
                         style="border-style: none;border-radius: 20px;margin-top: 30px;">
                        <h5 class="card-title">{{ item.title }}</h5>
                        <h6 class="text-muted card-subtitle mb-2">{{ item.price }} RUB</h6><a
                            class="text-center d-inline-block card-link" href="{{ item.link }}"
                            style="border-style: none;width: 100px;height: 30px;background: #2d2d2d;border-radius: 10px;color: rgb(152,152,152);margin-top: 10px;">Перейти</a><a
                            class="text-center d-inline-block card-link" href="#"
                            style="border-style: none;width: 100px;height: 30px;background: #2d2d2d;border-radius: 10px;color: rgb(152,152,152);margin-top: 10px;">{{ item.last_activity|date:"Y-m-d" | naturaltime}}</a><a
                            class="text-center d-inline-block card-link" href="{{ item.link }}"
                            style="border-style: none;width: 100px;height: 30px;background: #2d2d2d;border-radius: 10px;color: rgb(152,152,152);margin-top: 10px;">414ур.
                        </a>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
<style>
    input:focus {
        outline: #313131 2px solid;
    }
</style>
<script src="{% static 'market/assets/bootstrap/js/bootstrap.min.js' %}"></script>
<script src="{% static 'market/assets/js/bs-init.js' %}"></script>
</body>

</html>